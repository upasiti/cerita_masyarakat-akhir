export default class FavoritePage{async render(){return'\n      <section class="favorite-page">\n        <h1 tabindex="0">ğŸ“š Cerita Tersimpan</h1>\n        <div id="favorites-container" class="favorites-list"></div>\n      </section>\n    '}async afterRender(){const e=document.getElementById("favorites-container");if(!e)return;const t="favorites";let a;const n=()=>new Promise(((e,n)=>{const o=indexedDB.open("story-favorites-db",1);o.onupgradeneeded=e=>{a=e.target.result,a.objectStoreNames.contains(t)||a.createObjectStore(t,{keyPath:"id"})},o.onsuccess=t=>{a=t.target.result,e(a)},o.onerror=e=>{n(e.target.error)}})),o=async()=>{const a=await new Promise((async e=>{const a=(await n()).transaction(t,"readonly").objectStore(t).getAll();a.onsuccess=()=>e(a.result||[]),a.onerror=()=>e([])}));a.length?(e.innerHTML=a.map((e=>`\n          <article class="favorite-card" tabindex="0" data-id="${e.id}">\n            <img \n              src="${e.photoUrl}" \n              alt="Gambar ${e.name}" \n              class="favorite-image" \n              loading="lazy"\n            />\n            <h2 tabindex="0">${e.name}</h2>\n            <p>${e.description}</p>\n            <p class="story-date">${new Date(e.createdAt).toLocaleString("id-ID")}</p>\n            <div class="favorite-actions">\n              <button class="view-map" data-lat="${e.lat}" data-lon="${e.lon}">ğŸ“ Lihat Lokasi</button>\n              <button class="remove-fav" data-id="${e.id}">ğŸ—‘ï¸ Hapus</button>\n            </div>\n          </article>\n        `)).join(""),r()):e.innerHTML='\n          <p class="no-favorites" tabindex="0">Belum ada cerita yang disimpan ğŸ’¾</p>\n        '},r=()=>{document.querySelectorAll(".view-map").forEach((e=>{e.addEventListener("click",(()=>{const t=e.dataset.lat,a=e.dataset.lon;t&&a?window.open(`https://www.google.com/maps?q=${t},${a}`,"_blank"):alert("Lokasi tidak tersedia untuk cerita ini.")}))})),document.querySelectorAll(".remove-fav").forEach((e=>{e.addEventListener("click",(async()=>{const a=e.dataset.id;await(async e=>{const a=(await n()).transaction(t,"readwrite");a.objectStore(t).delete(e),a.oncomplete=()=>o()})(a)}))}))};await o()}}