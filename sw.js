const CACHE_VERSION="v3.2.0",CACHE_NAME="cerita-cache-v3.2.0",BASE_PATH="/cerita_masyarakat-akhir/";self.skipWaiting();const ASSETS_TO_CACHE=[`${BASE_PATH}`,`${BASE_PATH}index.html`,`${BASE_PATH}offline.html`,`${BASE_PATH}app.bundle.js`,`${BASE_PATH}app.css`,`${BASE_PATH}manifest.json`,`${BASE_PATH}images/icon-192.png`,`${BASE_PATH}images/icon-512.png`,`${BASE_PATH}images/logo.png`];self.addEventListener("install",(e=>{console.log("✅ Service Worker: Installed"),e.waitUntil(caches.open(CACHE_NAME).then((e=>e.addAll(ASSETS_TO_CACHE))))})),self.addEventListener("activate",(e=>{console.log("⚡ Service Worker: Activated"),e.waitUntil(caches.keys().then((e=>Promise.all(e.filter((e=>e!==CACHE_NAME)).map((e=>caches.delete(e)))))).then((()=>self.clients.claim())))})),self.addEventListener("fetch",(e=>{if("GET"!==e.request.method)return;const t=e.request,n=new URL(t.url),a=n.origin.includes("story-api.dicoding.dev");n.protocol.startsWith("chrome-extension")||e.respondWith((async()=>{const e=await caches.open(CACHE_NAME);try{const n=await fetch(t);return n&&404!==n.status?(e.put(t,n.clone()),n):await e.match(`${BASE_PATH}offline.html`)||new Response("Anda sedang offline.",{status:503})}catch{const n=await e.match(t);return n||(a?new Response(JSON.stringify({error:!0,message:"Offline – data tidak tersedia"}),{headers:{"Content-Type":"application/json"}}):await e.match(`${BASE_PATH}offline.html`)||new Response("Anda sedang offline.",{status:503}))}})())}));